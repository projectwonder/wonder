/** INGoogleMaps.js
 * @author Amedeo Mantica
 * @copyright Amedeo Mantica
 * @version 0.1
 * Source available on https://github.com/amedeomantica/INWebTools
 */
function IN_setupGoogleMaps(){var a=in_googleApiKey;var b=document.createElement("script");b.type="text/javascript";b.src="http://maps.googleapis.com/maps/api/js?key="+a+"&sensor=false&callback=IN_initializeMaps";document.body.appendChild(b)}window.IN_isIE=false;window.IN_GoogleMaps=Array();var IN_initializeMaps=function(){var a;var b=document.getElementsByTagName("div");for(a=0;a<b.length;a++){if(b[a].className.match(new RegExp("(\\s|^)"+"in_GoogleMap"+"(\\s|$)"))){window.IN_GoogleMaps[b[a].id]=new INGoogleMap(b[a])}}var c=function(a){var b=a.getAttribute("data-in_GoogleMap-id");if(window.IN_GoogleMaps[b]){window.IN_GoogleMaps[b].addMarker(a)}};var d=Array();var e=document.getElementsByTagName("address");for(a=0;a<e.length;a++){if(e[a].className.match(new RegExp("(\\s|^)"+"in_GoogleMapMarker"+"(\\s|$)"))){c(e[a])}}};var INGoogleMap=function(a){var b=Array();b["ROADMAP"]=google.maps.MapTypeId.ROADMAP;b["SATELLITE"]=google.maps.MapTypeId.SATELLITE;b["HYBRID"]=google.maps.MapTypeId.HYBRID;b["TERRAIN"]=google.maps.MapTypeId.TERRAIN;var c={zoom:parseInt(a.getAttribute("data-zoom")),center:new google.maps.LatLng(a.getAttribute("data-lat"),a.getAttribute("data-lng")),mapTypeId:b[a.getAttribute("data-type")]};this._map=new google.maps.Map(a,c)};INGoogleMap.prototype={addMarker:function(a){var b=new google.maps.LatLng(a.getAttribute("data-lat"),a.getAttribute("data-lng"));var c="Hello";var d=a.getAttribute("data-draggable")==="true"?true:false;var e=this._map;var f=a.innerHTML;var g=new google.maps.Marker({position:b,map:this._map,title:c,draggable:d});var h;var i;var j=document.getElementsByTagName("input");for(var k=0;k<j.length;k++){if(j[k].className.match(new RegExp("(\\s|^)"+"in_InputField"+"(\\s|$)"))){if(j[k].getAttribute("data-in_bound-object")){boundObjectId=j[k].getAttribute("data-in_bound-object");if(document.getElementById(boundObjectId)){boundObject=document.getElementById(boundObjectId);if(j[k].getAttribute("data-field")==="lng"&&j[k].getAttribute("data-in_bound-object")===a.id){i=j[k];i.value=a.getAttribute("data-lng")}if(j[k].getAttribute("data-field")==="lat"&&j[k].getAttribute("data-in_bound-object")===a.id){h=j[k];h.value=a.getAttribute("data-lat")}}}}}if(d){var l=function(b){var c=g.position.lng();var d=g.position.lat();if(i){i.value=c}if(h){h.value=d}a.setAttribute("data-lng",c);a.setAttribute("data-lat",d)};google.maps.event.addListener(g,"drag",l)}else{if(f){if(f!=""){var m=new google.maps.InfoWindow({content:f});google.maps.event.addListener(g,"click",function(){m.open(e,g)})}}}a.lookupAddress=function(a){var b=new google.maps.Geocoder;b.geocode({address:a},function(a,b){if(b=="OK"){g.setPosition(a[0].geometry.location);l();e.setCenter(a[0].geometry.location)}})}}};if(document.addEventListener){document.addEventListener("DOMContentLoaded",IN_setupGoogleMaps,false)}else if(document.attachEvent){window.IN_isIE=true;document.attachEvent("onreadystatechange",function(){if(document.readyState==="complete"){IN_setupGoogleMaps()}})}